/*! For license information please see c4b8d5b4489bf5d0bba7.js.LICENSE.txt */
function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,c=[],u=!0,s=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=a.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw o}}return c}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",c=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,i=Object.create(a.prototype),c=new L(r||[]);return o(i,"_invoke",{value:P(e,n,c)}),i}function p(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",d="suspendedYield",h="executing",m="completed",g={};function v(){}function y(){}function k(){}var _={};s(_,i,(function(){return this}));var b=Object.getPrototypeOf,x=b&&b(b(I([])));x&&x!==n&&r.call(x,i)&&(_=x);var w=k.prototype=v.prototype=Object.create(_);function E(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function n(o,a,i,c){var u=p(e[o],e,a);if("throw"!==u.type){var s=u.arg,l=s.value;return l&&"object"==_typeof(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,i,c)}),(function(e){n("throw",e,i,c)})):t.resolve(l).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,c)}))}c(u.arg)}var a;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return a=a?a.then(o,o):o()}})}function P(t,n,r){var o=f;return function(a,i){if(o===h)throw Error("Generator is already running");if(o===m){if("throw"===a)throw i;return{value:e,done:!0}}for(r.method=a,r.arg=i;;){var c=r.delegate;if(c){var u=B(c,r);if(u){if(u===g)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=h;var s=p(t,n,r);if("normal"===s.type){if(o=r.done?m:d,s.arg===g)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=m,r.method="throw",r.arg=s.arg)}}}function B(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,B(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=p(o,t.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var i=a.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function I(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}throw new TypeError(_typeof(t)+" is not iterable")}return y.prototype=k,o(w,"constructor",{value:k,configurable:!0}),o(k,"constructor",{value:y,configurable:!0}),y.displayName=s(k,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,s(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},E(R.prototype),s(R.prototype,c,(function(){return this})),t.AsyncIterator=R,t.async=function(e,n,r,o,a){void 0===a&&(a=Promise);var i=new R(l(e,n,r,o),a);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},E(w),s(w,u,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=I,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(S),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return c.type="throw",c.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],c=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(u&&s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;S(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:I(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}function asyncGeneratorStep(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){asyncGeneratorStep(a,r,o,i,c,"next",e)}function c(e){asyncGeneratorStep(a,r,o,i,c,"throw",e)}i(void 0)}))}}var git_values,environment,fileHandle,importConfigData=null,import3CXBackupData=null,fs=new FileReader,xml=new DOMParser,regexRows=/[^:0-9]/g,backupPhoneBooks={data:[]},importJsonOption={types:[{description:"Json Settings",accept:{"file/*":[".json"]}}],excludeAcceptAllOption:!0,multiple:!1},importXmlOption={types:[{description:"3CX Backup",accept:{"file/*":[".xml"]}}],excludeAcceptAllOption:!0,multiple:!1};function showHome(){document.getElementById("functions-container").style.display="none",document.getElementById("tools-container").style.display="none",document.getElementById("version-sel-container").style.display="block"}function showFunctions(e){document.getElementById("version-sel-container").style.display="none",document.getElementById("functions-container").style.display="grid",document.getElementById("tools-container").style.display="none"}function showTools(e){document.getElementById("version-sel-container").style.display="none",document.getElementById("functions-container").style.display="none",document.getElementById("tools-container").style.display="grid"}function readConfigFile(){return _readConfigFile.apply(this,arguments)}function _readConfigFile(){return(_readConfigFile=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:readFile(importJsonOption);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function read3CXBackup(){return _read3CXBackup.apply(this,arguments)}function _read3CXBackup(){return(_read3CXBackup=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:readFile(importXmlOption);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function readFile(e){return _readFile.apply(this,arguments)}function _readFile(){return(_readFile=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,o,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"web"!=environment){e.next=9;break}(n=document.createElement("input")).type="file",n.accept=t.types[0].accept["file/*"][0],n.click(),n.addEventListener("change",(function(e){var n=e.target.files[0],r=new FileReader;r.onload=function(e){console.log(e.target.result),onFileRead(e.target.result,t.types[0].accept["file/*"][0])},r.readAsText(n)})),e.next=23;break;case 9:return e.next=11,window.showOpenFilePicker(t);case 11:return r=e.sent,o=_slicedToArray(r,1),fileHandle=o[0],e.next=16,fileHandle.getFile();case 16:return a=e.sent,e.t0=onFileRead,e.next=20,a.text();case 20:e.t1=e.sent,e.t2=t.types[0].accept["file/*"][0],(0,e.t0)(e.t1,e.t2);case 23:e.next=28;break;case 25:e.prev=25,e.t3=e.catch(0),console.log(e.t3);case 28:case"end":return e.stop()}}),e,null,[[0,25]])})))).apply(this,arguments)}function onFileRead(e,t){return _onFileRead.apply(this,arguments)}function _onFileRead(){return(_onFileRead=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:".json"==n?updateSettings(importConfigData=JSON.parse(t)):updatePhonebook(import3CXBackupData=xml.parseFromString(t,"text/xml"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function updatePhonebook(e){return _updatePhonebook.apply(this,arguments)}function _updatePhonebook(){return(_updatePhonebook=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,o,a,i,c,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=t.querySelector("Tenants"),(r=n.querySelector("PhoneBookEntries")).hasChildNodes()&&backupPhoneBooks.data.push({name:"Company phonebook",data:populatePB([r])}),o=t.documentElement.querySelectorAll("Extension"),a=0;a<o.length;a++)i=o[a],(c=i.getElementsByTagName("PhoneBookEntries"))[0].hasChildNodes()&&(u="".concat(i.getElementsByTagName("Number")[0].innerHTML," - ").concat(i.getElementsByTagName("FirstName")[0].innerHTML),backupPhoneBooks.data.push({name:u,data:populatePB(c)}));createOptionsFromJSON("t-phonebook-list",backupPhoneBooks.data,"name"),console.log(backupPhoneBooks);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function populatePB(e){console.log(e);for(var t=e[0].getElementsByTagName("PhoneBookEntry"),n=[],r=function(){var e=new Array(18).fill("");t[o].childNodes.forEach((function(t,n){switch(t.tagName){case"FirstName":e[0]=t.innerHTML;break;case"LastName":e[1]=t.innerHTML;break;case"CompanyName":e[2]=t.innerHTML;break;case"PhoneNumber":e[3]=t.innerHTML;break;default:null!=t.tagName&&(e[n+4]=t.innerHTML)}})),e=filterArray(e,git_values.v20.template.backupImportFilter),n.push(e)},o=0;o<t.length;o++)r();return n}function updateSettings(e){return _updateSettings.apply(this,arguments)}function _updateSettings(){return(_updateSettings=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:createOptionsFromJSON("department",t.department,"Name"),createOptionsFromJSON("trunk",t.trunk,"TrunkName"),document.getElementById("fqdn").value=t.fqdn;case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function createOptionsFromJSON(e,t,n){for(var r=document.getElementById(e),o=0;o<t.length;o++){console.log(t);var a=document.createElement("option");a.innerText=t[o][n],a.value=o,r.appendChild(a)}r.value=0}Office.onReady((function(e){e.host===Office.HostType.Excel&&(console.log(e),document.getElementById("home-btn1").addEventListener("click",showHome),document.getElementById("home-btn2").addEventListener("click",showHome),document.getElementById("version-sel-btn20").addEventListener("click",showFunctions),document.getElementById("version-sel-btntools").addEventListener("click",showTools),document.getElementById("chrome").addEventListener("click",showHome),document.getElementById("f-gen-pages").addEventListener("click",genPagesBtn),document.getElementById("f-import-config").addEventListener("click",readConfigFile),document.getElementById("department-btn").addEventListener("click",addDepartment),document.getElementById("phone-brand-btn").addEventListener("click",addPhone),document.getElementById("f-gen-exts").addEventListener("click",genExt),document.getElementById("f-export-exts").addEventListener("click",exportExts),document.getElementById("f-gen-pbook").addEventListener("click",genPbook),document.getElementById("f-export-pbook").addEventListener("click",exportPhonebook),document.getElementById("t-3cxbackup").addEventListener("click",read3CXBackup),document.getElementById("load-bk-pbooks").addEventListener("click",loadPhonebook),document.getElementById("export-bk-download").addEventListener("click",exportPhonebookBackup),environment="excel",window!=window.top&&(environment="web"))}));export function run(){return _run.apply(this,arguments)}function _run(){return _run=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.workbook.getSelectedRange()).load("address"),n.format.fill.color="yellow",e.next=5,t.sync();case 5:console.log("The range address was ".concat(n.address,"."));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_run.apply(this,arguments)}export function loadPhonebook(){return _loadPhonebook.apply(this,arguments)}function _loadPhonebook(){return _loadPhonebook=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,o,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("null"!=(n=document.getElementById("t-phonebook-list").value)){for(r=[],o=0;o<backupPhoneBooks.data[n].data.length;o++)a=git_values.v20.template.pbook.slice(),r.push(combineArray(backupPhoneBooks.data[n].data[o],a,git_values.v20.template.backupImportOffset));t.workbook.worksheets.getItem("Out Phonebook").getRange("A2:N".concat(r.length+1)).values=r}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_loadPhonebook.apply(this,arguments)}export function addDepartment(){return _addDepartment.apply(this,arguments)}function _addDepartment(){return _addDepartment=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,o,a,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("TETS"),n=t.workbook.worksheets.getItem("Extentions"),e.next=4,advSelect(t,{columns:{start:"g",end:"g"}});case 4:for(r=e.sent,(o=n.getRange(r)).values="Sel. Department",a=[],i=0;i<importConfigData.department.length;i++)a.push(importConfigData.department[i].Name);console.log(a),o.dataValidation.rule={list:{inCellDropDown:!0,source:"".concat(a.join(","))}};case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_addDepartment.apply(this,arguments)}export function addPhone(){return _addPhone.apply(this,arguments)}function _addPhone(){return _addPhone=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,o,a,i,c,u,s,l,p,f;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem("Extentions"),r=document.getElementById("phone-brand").value,e.next=4,advSelect(t,{columns:{start:"h",end:"h"}});case 4:return o=e.sent,e.next=7,advSelect(t,{columns:{start:"k",end:"k"}});case 7:return a=e.sent,e.next=10,advSelect(t,{columns:{start:"i",end:"i"}});case 10:for(i=e.sent,c=n.getRange(o),u=n.getRange(a),s=n.getRange(i),c.values="Sel. Device",u.values="Sel. SBC",s.values="Sel. Lang",c.dataValidation.rule={list:{inCellDropDown:!0,source:"".concat(git_values.phones[r].models.join(","))}},s.dataValidation.rule={list:{inCellDropDown:!0,source:"".concat(git_values.phones[r].langs.join(","))}},l=[],p=0;p<importConfigData.sbc.length;p++)f=importConfigData.sbc[p].DisplayName,l.push(f);u.dataValidation.rule={list:{inCellDropDown:!0,source:"".concat(l.join(","))}};case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_addPhone.apply(this,arguments)}export function genPbook(){return _genPbook.apply(this,arguments)}function _genPbook(){return _genPbook=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,o,a,i,c;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem("Phonebook"),e.next=3,advSelect(t,{columns:{start:"a",end:"h"}});case 3:return r=e.sent,(o=n.getRange(r)).load("values"),e.next=8,t.sync();case 8:for(a=new Array(o.values.length),i=0;i<a.length;i++)c=git_values.v20.template.pbook.slice(),c=combineArray(o.values[i],c,git_values.v20.template.pbookOffset),a[i]=c;t.workbook.worksheets.getItem("Out Phonebook").getRange("A2:N".concat(a.length+1)).values=a;case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_genPbook.apply(this,arguments)}export function exportPhonebook(){return _exportPhonebook.apply(this,arguments)}function _exportPhonebook(){return _exportPhonebook=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,o,a,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem("Out Phonebook"),e.next=3,advSelect(t,{columns:{start:"a",end:"n"}});case 3:return r=e.sent,(o=n.getRange(r)).load("values"),e.next=8,t.sync();case 8:a=[git_values.v20.pages[3].data].concat(o.values),i=new Blob([a.join("\n")],{type:"text/plain"}),saveAs(i,"Phonebook.csv");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_exportPhonebook.apply(this,arguments)}export function genExt(){return _genExt.apply(this,arguments)}function _genExt(){return _genExt=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,o,a,i,c,u,s,l,p;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem("Extentions"),e.next=3,advSelect(t,{columns:{start:"a",end:"k"}});case 3:return r=e.sent,(o=n.getRange(r)).load("values"),e.next=8,t.sync();case 8:for(a=new Array(o.values.length),i=0;i<o.values.length;i++)c=git_values.v20.template.ext.slice(),(c=combineArray(o.values[i],c,git_values.v20.template.extOffset))[11]=(o.values[i][0]+o.values[i][1]).replace(/\s/g,""),c[20]=importConfigData.globalACPRMSET,c[22]=generateRandomPin(),""!=o.values[i][9]&&(u=retrivePhoneInfo(o.values[i][7]),s="",null!=u&&(c[13]=u.xml,c[17]=u.ring[0],c[18]=u.ring[1]),"Router"==o.values[i][10]&&(s=o.values[i][9]),"Router"!=o.values[i][10]&&"Local"!=o.values[i][10]&&retriveSBC(o.values[i][10])&&(s=retriveSBC(o.values[i][10])),c[15]=s),a[i]=c;l=t.workbook.worksheets.getItem("Out Extentions"),p=l.getRange("A2:AX".concat(a.length+1)),console.log({extRowData:o.values,dataOut:a}),p.values=a;case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_genExt.apply(this,arguments)}export function exportExts(){return _exportExts.apply(this,arguments)}function _exportExts(){return _exportExts=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,o,a,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.workbook.worksheets.getItem("Out Extentions"),e.next=3,advSelect(t,{columns:{start:"a",end:"ax"}});case 3:return r=e.sent,(o=n.getRange(r)).load("values"),e.next=8,t.sync();case 8:a=[git_values.v20.pages[2].data].concat(o.values),i=new Blob([a.join("\n")],{type:"text/plain"}),saveAs(i,"Extentions.csv");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_exportExts.apply(this,arguments)}function exportPhonebookBackup(){var e=document.getElementById("t-phonebook-list").value,t=new JSZip;if(console.log("test"),"null"!=e){for(var n=0;n<backupPhoneBooks.data.length;n++){var r=[];r.push(git_values.v20.pages[3].data.join(","));for(var o=0;o<backupPhoneBooks.data[n].data.length;o++){var a=git_values.v20.template.pbook.slice(),i=combineArray(backupPhoneBooks.data[n].data[o],a,git_values.v20.template.backupImportOffset);r.push(i.join(",")),console.log(r)}t.file("".concat(backupPhoneBooks.data[n].name,".csv"),r.join("\n"))}t.generateAsync({type:"blob"}).then((function(e){saveAs(e,"PhonebookBackup.zip")}))}}function retrivePhoneInfo(e){for(var t=0;t<git_values.phones.length;t++)if(console.log(git_values.phones[t]),git_values.phones[t].models.includes(e))return{xml:git_values.phones[t].xml,ring:git_values.phones[t].ring};return null}function retriveSBC(e){for(var t=0;t<importConfigData.sbc.length;t++)if(importConfigData.sbc[t].DisplayName==e)return""==importConfigData.sbc[t].PhoneMAC?importConfigData.sbc[t].Name:importConfigData.sbc[t].PhoneMAC;return null}function generateRandomPin(){for(var e="",t=0;t<6;t++)e+="0123456789"[Math.floor(10*Math.random())];return e}function advSelect(e,t){return _advSelect.apply(this,arguments)}function _advSelect(){return(_advSelect=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,o,a,i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.workbook.getSelectedRange()).load("address"),e.next=4,t.sync();case 4:for(o=r.address.split("!")[1],a=o.split(":"),i=0;i<a.length;i++)a[i]=a[i].replace(regexRows,""),1==a[i]&&(a[i]=2);if(1!=a.length||n.columns.start!=n.columns.end){e.next=9;break}return e.abrupt("return","".concat(n.columns.start).concat(a[0]));case 9:if(1!=a.length||n.columns.start==n.columns.end){e.next=12;break}return e.abrupt("return","".concat(n.columns.start).concat(a[0],":").concat(n.columns.end).concat(a[0]));case 12:return e.abrupt("return","".concat(n.columns.start).concat(a[0],":").concat(n.columns.end).concat(a[1]));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function genPagesBtn(){genPages(git_values.v20)}export function genPages(e){return _genPages.apply(this,arguments)}function _genPages(){return _genPages=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var r,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.workbook.worksheets.load("items/name"),o=new Array,e.next=4,n.sync();case 4:r.items.forEach((function(e){o.push(e.name)})),t.pages.forEach((function(e,t){0==o.includes(e.name)&&n.workbook.worksheets.add(e.name)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return e.next=5,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.pages.forEach((function(e){console.log(e);var t=numberToColumn(e.data.length-1),r=n.workbook.worksheets.getItem(e.name),o=r.getRange("A1:".concat(t,"1"));o.load("values"),o.values=[e.data],r.getRange("A:".concat(t)).numberFormat="@"}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),_genPages.apply(this,arguments)}function numberToColumn(e){var t="",n=Math.trunc(e/26);return n>0?(t+=String.fromCharCode(65+n-1),t+=String.fromCharCode(65+e%26)):t+=String.fromCharCode(65+e%26),t}function gitVal(){return _gitVal.apply(this,arguments)}function _gitVal(){return(_gitVal=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("https://raw.githubusercontent.com/ZSirag/3CX/main/settings.json").then((function(e){return e.json()})).then((function(e){git_values=e;for(var t=document.getElementById("phone-brand"),n=0;n<git_values.phones.length;n++){var r=document.createElement("option");r.innerHTML=git_values.phones[n].name,r.value=n,t.appendChild(r)}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function combineArray(e,t,n,r){if(console.log({sourceArray:e,destArray:t}),r)for(var o=0;o<r;o++)t[n[o]]=e[o];else for(var a=0;a<e.length;a++)t[n[a]]=e[a];return t}function filterArray(e,t){for(var n=new Array(t.length).fill(""),r=0;r<t.length;r++)n[r]=e[t[r]];return n}gitVal();