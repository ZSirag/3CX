/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={98362:function(e,t,n){e.exports=n.p+"assets/logo-filled.png"},98388:function(e,t,n){e.exports=n.p+"b116cb09288947d8842f.js"},44329:function(e,t,n){e.exports=n.p+"7aaf144e7f97f9c3f0c3.js"},54058:function(e,t,n){e.exports=n.p+"c4b8d5b4489bf5d0bba7.js"},58394:function(e,t,n){e.exports=n.p+"cb60821976b195652f11.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r](a,a.exports,n),a.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(){n=function(){return r};var t,r={},o=Object.prototype,a=o.hasOwnProperty,c=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function p(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{p({},"")}catch(t){p=function(e,t,n){return e[t]=n}}function f(e,t,n,r){var o=t&&t.prototype instanceof w?t:w,a=Object.create(o.prototype),i=new T(r||[]);return c(a,"_invoke",{value:j(e,n,i)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var d="suspendedStart",m="suspendedYield",v="executing",y="completed",g={};function w(){}function b(){}function k(){}var x={};p(x,s,(function(){return this}));var E=Object.getPrototypeOf,L=E&&E(E(P([])));L&&L!==o&&a.call(L,s)&&(x=L);var I=k.prototype=w.prototype=Object.create(x);function B(e){["next","throw","return"].forEach((function(t){p(e,t,(function(e){return this._invoke(t,e)}))}))}function S(t,n){function r(o,c,i,s){var u=h(t[o],t,c);if("throw"!==u.type){var l=u.arg,p=l.value;return p&&"object"==e(p)&&a.call(p,"__await")?n.resolve(p.__await).then((function(e){r("next",e,i,s)}),(function(e){r("throw",e,i,s)})):n.resolve(p).then((function(e){l.value=e,i(l)}),(function(e){return r("throw",e,i,s)}))}s(u.arg)}var o;c(this,"_invoke",{value:function(e,t){function a(){return new n((function(n,o){r(e,t,n,o)}))}return o=o?o.then(a,a):a()}})}function j(e,n,r){var o=d;return function(a,c){if(o===v)throw Error("Generator is already running");if(o===y){if("throw"===a)throw c;return{value:t,done:!0}}for(r.method=a,r.arg=c;;){var i=r.delegate;if(i){var s=O(i,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=v;var u=h(e,n,r);if("normal"===u.type){if(o=r.done?y:m,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=h(o,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var c=a.arg;return c?c.done?(n[e.resultName]=c.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function P(n){if(n||""===n){var r=n[s];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,c=function e(){for(;++o<n.length;)if(a.call(n,o))return e.value=n[o],e.done=!1,e;return e.value=t,e.done=!0,e};return c.next=c}}throw new TypeError(e(n)+" is not iterable")}return b.prototype=k,c(I,"constructor",{value:k,configurable:!0}),c(k,"constructor",{value:b,configurable:!0}),b.displayName=p(k,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,k):(e.__proto__=k,p(e,l,"GeneratorFunction")),e.prototype=Object.create(I),e},r.awrap=function(e){return{__await:e}},B(S.prototype),p(S.prototype,u,(function(){return this})),r.AsyncIterator=S,r.async=function(e,t,n,o,a){void 0===a&&(a=Promise);var c=new S(f(e,t,n,o),a);return r.isGeneratorFunction(t)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},B(I),p(I,l,"Generator"),p(I,s,(function(){return this})),p(I,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},r.values=P,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,o){return i.type="throw",i.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var c=this.tryEntries[o],i=c.completion;if("root"===c.tryLoc)return r("end");if(c.tryLoc<=this.prev){var s=a.call(c,"catchLoc"),u=a.call(c,"finallyLoc");if(s&&u){if(this.prev<c.catchLoc)return r(c.catchLoc,!0);if(this.prev<c.finallyLoc)return r(c.finallyLoc)}else if(s){if(this.prev<c.catchLoc)return r(c.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return r(c.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var c=o?o.completion:{};return c.type=e,c.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(c)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),N(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;N(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:P(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},r}function r(e,t,n,r,o,a,c){try{var i=e[a](c),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,o)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var c=e.apply(t,n);function i(e){r(c,o,a,i,s,"next",e)}function s(e){r(c,o,a,i,s,"throw",e)}i(void 0)}))}}var a,c,i,s=null,u=(new FileReader,new DOMParser),l=/[^:0-9]/g,p={data:[]},f={types:[{description:"Json Settings",accept:{"file/*":[".json"]}}],excludeAcceptAllOption:!0,multiple:!1},h={types:[{description:"3CX Backup",accept:{"file/*":[".xml"]}}],excludeAcceptAllOption:!0,multiple:!1};function d(){document.getElementById("functions-container").style.display="none",document.getElementById("tools-container").style.display="none",document.getElementById("version-sel-container").style.display="block"}function m(e){document.getElementById("version-sel-container").style.display="none",document.getElementById("functions-container").style.display="grid",document.getElementById("tools-container").style.display="none"}function v(e){document.getElementById("version-sel-container").style.display="none",document.getElementById("functions-container").style.display="none",document.getElementById("tools-container").style.display="grid"}function y(){return g.apply(this,arguments)}function g(){return(g=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(f);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){return b.apply(this,arguments)}function b(){return(b=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k(h);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){return x.apply(this,arguments)}function x(){return(x=o(n().mark((function e(r){var o,a,s,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,"web"!=c){e.next=9;break}(o=document.createElement("input")).type="file",o.accept=r.types[0].accept["file/*"][0],o.click(),o.addEventListener("change",(function(e){var t=e.target.files[0],n=new FileReader;n.onload=function(e){console.log(e.target.result),E(e.target.result,r.types[0].accept["file/*"][0])},n.readAsText(t)})),e.next=23;break;case 9:return e.next=11,window.showOpenFilePicker(r);case 11:return a=e.sent,l=1,s=function(e){if(Array.isArray(e))return e}(n=a)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,c,i=[],s=!0,u=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=a.call(n)).done)&&(i.push(r.value),i.length!==t);s=!0);}catch(e){u=!0,o=e}finally{try{if(!s&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(u)throw o}}return i}}(n,l)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(n,l)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),i=s[0],e.next=16,i.getFile();case 16:return u=e.sent,e.t0=E,e.next=20,u.text();case 20:e.t1=e.sent,e.t2=r.types[0].accept["file/*"][0],(0,e.t0)(e.t1,e.t2);case 23:e.next=28;break;case 25:e.prev=25,e.t3=e.catch(0),console.log(e.t3);case 28:case"end":return e.stop()}var n,l}),e,null,[[0,25]])})))).apply(this,arguments)}function E(e,t){return L.apply(this,arguments)}function L(){return(L=o(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:".json"==r?j(s=JSON.parse(t)):I(u.parseFromString(t,"text/xml"));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(e){return B.apply(this,arguments)}function B(){return(B=o(n().mark((function e(t){var r,o,a,c,i,s,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=t.querySelector("Tenants"),(o=r.querySelector("PhoneBookEntries")).hasChildNodes()&&p.data.push({name:"Company phonebook",data:S([o])}),a=t.documentElement.querySelectorAll("Extension"),c=0;c<a.length;c++)i=a[c],(s=i.getElementsByTagName("PhoneBookEntries"))[0].hasChildNodes()&&(u="".concat(i.getElementsByTagName("Number")[0].innerHTML," - ").concat(i.getElementsByTagName("FirstName")[0].innerHTML),p.data.push({name:u,data:S(s)}));A("t-phonebook-list",p.data,"name"),console.log(p);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){console.log(e);for(var t=e[0].getElementsByTagName("PhoneBookEntry"),n=[],r=function(){var e=new Array(18).fill("");t[o].childNodes.forEach((function(t,n){switch(t.tagName){case"FirstName":e[0]=t.innerHTML;break;case"LastName":e[1]=t.innerHTML;break;case"CompanyName":e[2]=t.innerHTML;break;case"PhoneNumber":e[3]=t.innerHTML;break;default:null!=t.tagName&&(e[n+4]=t.innerHTML)}})),e=function(e,t){for(var n=new Array(t.length).fill(""),r=0;r<t.length;r++)n[r]=e[t[r]];return n}(e,a.v20.template.backupImportFilter),n.push(e)},o=0;o<t.length;o++)r();return n}function j(e){return O.apply(this,arguments)}function O(){return(O=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:A("department",t.department,"Name"),A("trunk",t.trunk,"TrunkName"),document.getElementById("fqdn").value=t.fqdn;case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t,n){for(var r=document.getElementById(e),o=0;o<t.length;o++){console.log(t);var a=document.createElement("option");a.innerText=t[o][n],a.value=o,r.appendChild(a)}r.value=0}function N(){return T.apply(this,arguments)}function T(){return T=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=o(n().mark((function e(t){var r,o,c,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("null"!=(r=document.getElementById("t-phonebook-list").value)){for(o=[],c=0;c<p.data[r].data.length;c++)i=a.v20.template.pbook.slice(),o.push(ee(p.data[r].data[c],i,a.v20.template.backupImportOffset));t.workbook.worksheets.getItem("Out Phonebook").getRange("A2:N".concat(o.length+1)).values=o}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),T.apply(this,arguments)}function P(){return R.apply(this,arguments)}function R(){return R=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=o(n().mark((function e(t){var r,o,a,c,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("TETS"),r=t.workbook.worksheets.getItem("Extentions"),e.next=4,Z(t,{columns:{start:"g",end:"g"}});case 4:for(o=e.sent,(a=r.getRange(o)).values="Sel. Department",c=[],i=0;i<s.department.length;i++)c.push(s.department[i].Name);console.log(c),a.dataValidation.rule={list:{inCellDropDown:!0,source:"".concat(c.join(","))}};case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),R.apply(this,arguments)}function C(){return M.apply(this,arguments)}function M(){return M=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=o(n().mark((function e(t){var r,o,c,i,u,l,p,f,h,d,m;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.workbook.worksheets.getItem("Extentions"),o=document.getElementById("phone-brand").value,e.next=4,Z(t,{columns:{start:"h",end:"h"}});case 4:return c=e.sent,e.next=7,Z(t,{columns:{start:"k",end:"k"}});case 7:return i=e.sent,e.next=10,Z(t,{columns:{start:"i",end:"i"}});case 10:for(u=e.sent,l=r.getRange(c),p=r.getRange(i),f=r.getRange(u),l.values="Sel. Device",p.values="Sel. SBC",f.values="Sel. Lang",l.dataValidation.rule={list:{inCellDropDown:!0,source:"".concat(a.phones[o].models.join(","))}},f.dataValidation.rule={list:{inCellDropDown:!0,source:"".concat(a.phones[o].langs.join(","))}},h=[],d=0;d<s.sbc.length;d++)m=s.sbc[d].DisplayName,h.push(m);p.dataValidation.rule={list:{inCellDropDown:!0,source:"".concat(h.join(","))}};case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),M.apply(this,arguments)}function F(){return _.apply(this,arguments)}function _(){return _=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=o(n().mark((function e(t){var r,o,c,i,s,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.workbook.worksheets.getItem("Phonebook"),e.next=3,Z(t,{columns:{start:"a",end:"h"}});case 3:return o=e.sent,(c=r.getRange(o)).load("values"),e.next=8,t.sync();case 8:for(i=new Array(c.values.length),s=0;s<i.length;s++)u=a.v20.template.pbook.slice(),u=ee(c.values[s],u,a.v20.template.pbookOffset),i[s]=u;t.workbook.worksheets.getItem("Out Phonebook").getRange("A2:N".concat(i.length+1)).values=i;case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),_.apply(this,arguments)}function D(){return H.apply(this,arguments)}function H(){return H=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=o(n().mark((function e(t){var r,o,c,i,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.workbook.worksheets.getItem("Out Phonebook"),e.next=3,Z(t,{columns:{start:"a",end:"n"}});case 3:return o=e.sent,(c=r.getRange(o)).load("values"),e.next=8,t.sync();case 8:i=[a.v20.pages[3].data].concat(c.values),s=new Blob([i.join("\n")],{type:"text/plain"}),saveAs(s,"Phonebook.csv");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),H.apply(this,arguments)}function G(){return U.apply(this,arguments)}function U(){return U=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=o(n().mark((function e(t){var r,o,c,i,u,l,p,f,h,d;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.workbook.worksheets.getItem("Extentions"),e.next=3,Z(t,{columns:{start:"a",end:"k"}});case 3:return o=e.sent,(c=r.getRange(o)).load("values"),e.next=8,t.sync();case 8:for(i=new Array(c.values.length),u=0;u<c.values.length;u++)l=a.v20.template.ext.slice(),(l=ee(c.values[u],l,a.v20.template.extOffset))[11]=(c.values[u][0]+c.values[u][1]).replace(/\s/g,""),l[20]=s.globalACPRMSET,l[22]=Y(),""!=c.values[u][9]&&(p=J(c.values[u][7]),f="",null!=p&&(l[13]=p.xml,l[17]=p.ring[0],l[18]=p.ring[1]),"Router"==c.values[u][10]&&(f=c.values[u][9]),"Router"!=c.values[u][10]&&"Local"!=c.values[u][10]&&X(c.values[u][10])&&(f=X(c.values[u][10])),l[15]=f),i[u]=l;h=t.workbook.worksheets.getItem("Out Extentions"),d=h.getRange("A2:AX".concat(i.length+1)),console.log({extRowData:c.values,dataOut:i}),d.values=i;case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),U.apply(this,arguments)}function q(){return V.apply(this,arguments)}function V(){return V=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=o(n().mark((function e(t){var r,o,c,i,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.workbook.worksheets.getItem("Out Extentions"),e.next=3,Z(t,{columns:{start:"a",end:"ax"}});case 3:return o=e.sent,(c=r.getRange(o)).load("values"),e.next=8,t.sync();case 8:i=[a.v20.pages[2].data].concat(c.values),s=new Blob([i.join("\n")],{type:"text/plain"}),saveAs(s,"Extentions.csv");case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])}))),V.apply(this,arguments)}function $(){var e=document.getElementById("t-phonebook-list").value,t=new JSZip;if(console.log("test"),"null"!=e){for(var n=0;n<p.data.length;n++){var r=[];r.push(a.v20.pages[3].data.join(","));for(var o=0;o<p.data[n].data.length;o++){var c=a.v20.template.pbook.slice(),i=ee(p.data[n].data[o],c,a.v20.template.backupImportOffset);r.push(i.join(",")),console.log(r)}t.file("".concat(p.data[n].name,".csv"),r.join("\n"))}t.generateAsync({type:"blob"}).then((function(e){saveAs(e,"PhonebookBackup.zip")}))}}function J(e){for(var t=0;t<a.phones.length;t++)if(console.log(a.phones[t]),a.phones[t].models.includes(e))return{xml:a.phones[t].xml,ring:a.phones[t].ring};return null}function X(e){for(var t=0;t<s.sbc.length;t++)if(s.sbc[t].DisplayName==e)return""==s.sbc[t].PhoneMAC?s.sbc[t].Name:s.sbc[t].PhoneMAC;return null}function Y(){for(var e="",t=0;t<6;t++)e+="0123456789"[Math.floor(10*Math.random())];return e}function Z(e,t){return z.apply(this,arguments)}function z(){return(z=o(n().mark((function e(t,r){var o,a,c,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=t.workbook.getSelectedRange()).load("address"),e.next=4,t.sync();case 4:for(a=o.address.split("!")[1],c=a.split(":"),i=0;i<c.length;i++)c[i]=c[i].replace(l,""),1==c[i]&&(c[i]=2);if(1!=c.length||r.columns.start!=r.columns.end){e.next=9;break}return e.abrupt("return","".concat(r.columns.start).concat(c[0]));case 9:if(1!=c.length||r.columns.start==r.columns.end){e.next=12;break}return e.abrupt("return","".concat(r.columns.start).concat(c[0],":").concat(r.columns.end).concat(c[0]));case 12:return e.abrupt("return","".concat(r.columns.start).concat(c[0],":").concat(r.columns.end).concat(c[1]));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function K(){!function(e){Q.apply(this,arguments)}(a.v20)}function Q(){return Q=o(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Excel.run(function(){var e=o(n().mark((function e(r){var o,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=r.workbook.worksheets.load("items/name"),a=new Array,e.next=4,r.sync();case 4:o.items.forEach((function(e){a.push(e.name)})),t.pages.forEach((function(e,t){0==a.includes(e.name)&&r.workbook.worksheets.add(e.name)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:return e.next=5,Excel.run(function(){var e=o(n().mark((function e(r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.pages.forEach((function(e){console.log(e);var t,n,o,a=(t=e.data.length-1,n="",(o=Math.trunc(t/26))>0?(n+=String.fromCharCode(65+o-1),n+=String.fromCharCode(65+t%26)):n+=String.fromCharCode(65+t%26),n),c=r.workbook.worksheets.getItem(e.name),i=c.getRange("A1:".concat(a,"1"));i.load("values"),i.values=[e.data],c.getRange("A:".concat(a)).numberFormat="@"}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),Q.apply(this,arguments)}function W(){return(W=o(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:fetch("https://raw.githubusercontent.com/ZSirag/3CX/main/settings.json").then((function(e){return e.json()})).then((function(e){a=e;for(var t=document.getElementById("phone-brand"),n=0;n<a.phones.length;n++){var r=document.createElement("option");r.innerHTML=a.phones[n].name,r.value=n,t.appendChild(r)}}));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(e,t,n,r){if(console.log({sourceArray:e,destArray:t}),r)for(var o=0;o<r;o++)t[n[o]]=e[o];else for(var a=0;a<e.length;a++)t[n[a]]=e[a];return t}Office.onReady((function(e){e.host===Office.HostType.Excel&&(console.log(e),document.getElementById("home-btn1").addEventListener("click",d),document.getElementById("home-btn2").addEventListener("click",d),document.getElementById("version-sel-btn20").addEventListener("click",m),document.getElementById("version-sel-btntools").addEventListener("click",v),document.getElementById("chrome").addEventListener("click",d),document.getElementById("f-gen-pages").addEventListener("click",K),document.getElementById("f-import-config").addEventListener("click",y),document.getElementById("department-btn").addEventListener("click",P),document.getElementById("phone-brand-btn").addEventListener("click",C),document.getElementById("f-gen-exts").addEventListener("click",G),document.getElementById("f-export-exts").addEventListener("click",q),document.getElementById("f-gen-pbook").addEventListener("click",F),document.getElementById("f-export-pbook").addEventListener("click",D),document.getElementById("t-3cxbackup").addEventListener("click",w),document.getElementById("load-bk-pbooks").addEventListener("click",N),document.getElementById("export-bk-download").addEventListener("click",$),c="excel",window!=window.top&&(c="web"))})),function(){W.apply(this,arguments)}()}(),new URL(n(98388),n.b),new URL(n(44329),n.b),new URL(n(54058),n.b),new URL(n(58394),n.b),new URL(n(98362),n.b)}();
//# sourceMappingURL=taskpane.js.map